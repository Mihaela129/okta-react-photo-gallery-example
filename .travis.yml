os:
- linux
services:
- docker
language: node_js
node_js:
- 8.11.2
jdk:
- oraclejdk8
sudo: false
cache:
  directories:
  - node
  - node_modules
  - "$HOME/.m2"
  - "$HOME/.yarn-cache"
env:
  global:
  - NODE_VERSION=8.11.2
  - SPRING_OUTPUT_ANSI_ENABLED=ALWAYS
  - SPRING_JPA_SHOW_SQL=false
before_install:
- jdk_switcher use oraclejdk8
- java -version
- sudo /etc/init.d/mysql stop
- sudo /etc/init.d/postgresql stop
- curl -o- -L https://yarnpkg.com/install.sh | bash
- export PATH=$HOME/.yarn/bin:$PATH
install:
- yarn install
script:
- chmod +x mvnw
- "./mvnw clean test"
- yarn test
- "./mvnw com.heroku.sdk:heroku-maven-plugin:1.1.1:deploy -DskipTests -Pprod -Dheroku.appName=gallery-pwa"
notifications:
  webhooks:
    on_success: change
    on_failure: always
    on_start: false
deploy:
  provider: heroku
  api_key:
    secure: a9YvvdQVjgo5foFKsv53l85h8Nae/De5oCTq4LbTce0Sb7kPx3oFZTUYyrFgG0bxsT7hxh3RRI6UckaPj18nr75grQ12OJAoNi/pGJp6PaWZbmWoowmrPSC4giDbChU67i1Qy599LBEizJxaWo2PTLBpWCG1weSU67l4Ksmr8sM3tRrof9cvjYBOZSyIoDBe2u4JmBlaBGCI3NGrAyK7BhA4AtGkP+wreWFcMhop3r+k4Nrquv6RKJfTR25OV/NcIizG4Gsn5lKE5EBgeSXnJobLx4jhExJC5g90zS92eCmo7QgHQDbspoT6ScQrOdg4DGFzvND1oAfMU/sgVKYR3OM2jIGZfJjhKScNidcXLkf/YQUxbF1YcSsXJmXzOiBMyh+PKbYtheE5SHF6+mZAkVrn/m8GyRSJy6rPVGgNLgdIHKqxSwpbcB66qyCd4d9HjK7aq6BnmJay1u4qeu/9pekddr4+yetaseTzrzzk/Wm9yn981f7WcfLpyOm1KcudRtWR6CObYgtT7dU3686f2EMhTXUM7ZSvyt5Y3nqbjgUXA0JlWrNicCbV+8LrXV11y19B++jxGrFtW5TzBQS6Q0j5HAClPnS3k1lnU3MpCaeBnc8kzaYdLhDPt4k0CHAaykv70wj786OyOOwXEWcaLER0M6+UlrCq4Oh6kXU/fYI=
